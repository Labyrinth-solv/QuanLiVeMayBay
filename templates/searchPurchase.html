<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Search & Purchase Flights</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap/css/bootstrap.min.css') }}">

    <link rel="icon" href="{{ url_for('static', filename='img/favicon-32x32.png') }}" type="image/png">
</head>

<!-- ✅ 2. Thêm nền xám nhạt cho toàn trang -->
<body class="bg-light">

<!-- ✅ 3. Xây dựng Header bằng class của Bootstrap -->
<header class="bg-white shadow-sm border-bottom">
    <div class="container py-3">
        <!-- Dùng Flexbox để căn chỉnh 2 bên -->
        <div class="d-flex flex-wrap justify-content-between align-items-center">

            <!-- Phần chào mừng bên trái -->
            <div class="mb-2 mb-md-0">
                <h1 class="h4 mb-0">Welcome, {{name}}.</h1>
            </div>

            <!-- Nút Logout bên phải -->
            <div class="text-end">
                <a href="/customerHome" class="btn btn-outline-secondary me-2">Home</a>
                <a href="/customerLogout" class="btn btn-outline-danger">Logout</a>
            </div>
        </div>
    </div>
</header>

<!-- ✅ 4. Dùng Container cho nội dung chính -->
<main class="container my-5">

    <h2 class="mb-3">Available Flights</h2>

    {% if flights %}
    <form action="/purchase" method="POST">
        <!-- ✅ 5. Bọc bảng trong Card và 'table-responsive' -->
        <div class="card shadow-sm">
            <div class="table-responsive">
                <table class="table table-striped table-hover mb-0">
                    <thead class="table-dark">
                        <tr>
                            <th>Airline Name</th>
                            <th>Flight #</th>
                            <th>Source</th>
                            <th>Destination</th>
                            <th>Departure</th>
                            <th>Arrival</th>
                            <th>Price</th>
                            <th>Status</th>
                            <th>Available</th>
                            <th class="text-center">Select</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for f in flights %}
                        <tr>
                            <td>{{ f.name }}</td>
                            <td>{{ f.flight_number }}</td>
                            <td>{{ f.dep_airport }}</td>
                            <td>{{ f.arr_airport }}</td>
                            <td>{{ f.dep_date_time }}</td>
                            <td>{{ f.arr_date_time }}</td>
                            <!-- Thêm định dạng tiền tệ -->
                            <td>${{ "{:,.0f}".format(f.base_price) }}</td>
                            <td>{{ f.status }}</td>
                            <td>{{ f.available_seats }}</td>
                            <!-- ✅ 6. Căn giữa và dùng form-check-input -->
                            <td class="text-center">
                                <input class="form-check-input" type="radio" name="selected_flight" value="{{ f.name }}|{{ f.flight_number }}" required>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div><!-- Hết .table-responsive -->

            <!-- ✅ 7. Đặt nút Submit ở card-footer -->
            <div class="card-footer text-end">
                <button type="submit" class="btn btn-primary btn-lg">Purchase Selected Flight</button>
            </div>
        </div><!-- Hết .card -->
    </form>

    {% else %}
    <!-- ✅ 8. Dùng 'alert' khi không có chuyến bay -->
    <div class="alert alert-info" role="alert">
        No flights available at the moment.
    </div>
    {% endif %}


    {% if flight_info %}
    <!-- ✅ 9. Dùng đường phân cách 'my-5' (margin top/bottom 5) -->
    <hr class="my-5">

    <!-- ✅ 10. Dùng Card cho
     màn hình xác nhận -->
    <div class="card shadow-sm border-success">
        <div class="card-header bg-success text-white">
            <h2 class="h4 mb-0">Confirm Purchase</h2>
        </div>
        <div class="card-body">

            <!-- Dùng "Description List" (dl) để hiển thị thông tin -->
            <dl class="row mb-4">
                <dt class="col-sm-3">Customer:</dt>
                <dd class="col-sm-9">{{ name }}</dd>

                <dt class="col-sm-3">Flight:</dt>
                <dd class="col-sm-9">{{ flight_info.name }} {{ flight_info.flight_number }}</dd>

                <dt class="col-sm-3">Route:</dt>
                <dd class="col-sm-9">{{ flight_info.dep_airport }} → {{ flight_info.arr_airport }}</dd>

                <dt class="col-sm-3">Price:</dt>
                <dd class="col-sm-9 h5">${{ "{:,.0f}".format(flight_info.base_price) }}</dd>
            </dl>

            <form action="/purchaseInfo" method="POST">
                <input type="hidden" name="airline_name" value="{{ flight_info.name }}">
                <input type="hidden" name="flight_number" value="{{ flight_info.flight_number }}">
                <input type="hidden" name="sold_price" value="{{ flight_info.base_price }}">
                <button type="submit" class="btn btn-success btn-lg">Confirm Purchase</button>
            </form>
        </div>
    </div>
    {% endif %}


    <!-- ✅ 11. Dùng 'alert' cho message (nếu có) -->
    {% if message %}
    <div class="alert alert-success mt-4" role="alert">
        {{ message }}
    </div>
    {% endif %}

</main> <!-- Hết .container -->

</body>
</html>