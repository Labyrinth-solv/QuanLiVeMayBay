<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Search & Purchase Flights</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

<div class="app-panel">
    <header>
        <h1>Welcome {{ name }}</h1>
        <a href="/customerLogout">Logout</a> |
        <a href="/customerHome">Home</a>
        <hr>
    </header>

    <main>
        <h2>Available Flights</h2>

        {% if flights %}
        <form action="/purchase" method="POST">
            <table border="1" cellpadding="5">
                <thead>
                    <tr>
                        <th>Airline Name</th>
                        <th>Flight Number</th>
                        <th>Source</th>
                        <th>Destination</th>
                        <th>Departure</th>
                        <th>Arrival</th>
                        <th>Price</th>
                        <th>Status</th>
                        <th>Available Seats</th>
                        <th>Select</th>
                    </tr>
                </thead>
                <tbody>
                    {% for f in flights %}
                    <tr>
                        <td>{{ f.name }}</td>
                        <td>{{ f.flight_number }}</td>
                        <td>{{ f.dep_airport }}</td>
                        <td>{{ f.arr_airport }}</td>
                        <td>{{ f.dep_date_time }}</td>
                        <td>{{ f.arr_date_time }}</td>
                        <td>{{ f.base_price }}</td>
                        <td>{{ f.status }}</td>
                        <td>{{ f.available_seats }}</td>
                        <td>
                            <input type="radio" name="selected_flight" value="{{ f.name }}|{{ f.flight_number }}" required>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <br>
            <button type="submit">Purchase Selected Flight</button>
        </form>
        {% else %}
        <p>No flights available at the moment.</p>
        {% endif %}

        {% if flight_info %}
        <hr>
        <h2>Confirm Purchase</h2>
        <p><strong>Customer:</strong> {{ name }}</p>
        <p><strong>Flight:</strong> {{ flight_info.name }} {{ flight_info.flight_number }}</p>
        <p><strong>Route:</strong> {{ flight_info.dep_airport }} â†’ {{ flight_info.arr_airport }}</p>
        <p><strong>Price:</strong> {{ flight_info.base_price }}</p>

        <form action="/purchaseInfo" method="POST">
            <input type="hidden" name="airline_name" value="{{ flight_info.name }}">
            <input type="hidden" name="flight_number" value="{{ flight_info.flight_number }}">
            <input type="hidden" name="sold_price" value="{{ flight_info.base_price }}">
            <button type="submit">Confirm Purchase</button>
        </form>
        {% endif %}


        {% if message %}
        <p style="color: green;">{{ message }}</p>
        {% endif %}
    </main>
</div>
</body>
</html>
